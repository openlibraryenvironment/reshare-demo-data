<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<transformationStep>
    <id>301304</id>
    <XmlTransformStep>
        <id>301304</id>
        <description>Holdings and Items, Millersville</description>
        <enabled>true</enabled>
        <inputFormat>XML</inputFormat>
        <name>Holdings and Items, Millersville</name>
        <outputFormat>XML</outputFormat>
        <script>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&#xD;
&lt;xsl:stylesheet&#xD;
  version="1.0"&#xD;
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&#xD;
  xmlns:marc="http://www.loc.gov/MARC21/slim"&#xD;
  xmlns:oai20="http://www.openarchives.org/OAI/2.0/"&#xD;
  &gt;&#xD;
&#xD;
  &lt;xsl:strip-space elements="*"/&gt;&#xD;
  &lt;xsl:output indent="yes" method="xml" version="1.0" encoding="UTF-8"/&gt;&#xD;
&#xD;
  &lt;xsl:template match="collection"&gt;&#xD;
    &lt;collection&gt;&#xD;
        &lt;xsl:apply-templates/&gt;&#xD;
    &lt;/collection&gt;&#xD;
  &lt;/xsl:template&gt;&#xD;
&#xD;
  &lt;xsl:template match="record"&gt;&#xD;
    &lt;record&gt;&#xD;
        &lt;xsl:for-each select="@* | node()"&gt;&#xD;
            &lt;xsl:copy-of select="."/&gt;&#xD;
        &lt;/xsl:for-each&gt;&#xD;
        &lt;xsl:apply-templates/&gt;&#xD;
    &lt;/record&gt;&#xD;
  &lt;/xsl:template&gt;&#xD;
&#xD;
  &lt;xsl:variable name="WILL_LEND"&gt;46970b40-918e-47a4-a45d-b1677a2d3d46&lt;/xsl:variable&gt; &lt;!-- FOLIO Inventory ILL Policy value 'Will lend' --&gt;&#xD;
  &lt;xsl:variable name="WILL_NOT_LEND"&gt;b0f97013-87f5-4bab-87f2-ac4a5191b489&lt;/xsl:variable&gt; &lt;!-- FOLIO Inventory ILL Policy value 'Will not lend' --&gt;&#xD;
&#xD;
  &lt;xsl:template match="//marc:record"&gt;&#xD;
    &lt;holdingsRecords&gt;&#xD;
        &lt;xsl:choose&gt;&#xD;
            &lt;xsl:when test="marc:datafield[@tag='900' and @ind1!='4' and @ind1!=' ']"&gt;&#xD;
                &lt;arr&gt;&#xD;
                    &lt;xsl:for-each select="marc:datafield[@tag='900' and @ind1!='4' and @ind1!=' ']"&gt;&#xD;
                    &lt;xsl:variable name="holdingsId" select="marc:subfield[@code='8']"/&gt;&#xD;
                    &lt;i&gt;&#xD;
                        &lt;formerIds&gt;&#xD;
                        &lt;arr&gt;&#xD;
                            &lt;i&gt;&#xD;
                                &lt;xsl:value-of select="marc:subfield[@code='8']"/&gt;&#xD;
                            &lt;/i&gt;&#xD;
                        &lt;/arr&gt;&#xD;
                        &lt;/formerIds&gt;&#xD;
                        &lt;illPolicyId&gt;&#xD;
                        &lt;xsl:choose&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='AID'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='B'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='BD'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='BDVD'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='BIND'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='BO'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='CAT'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='CKT'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='CPOS'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='CT'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='CTO'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EA_AUDIO'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_ACLS'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_CHO'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_EAI'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_EBRARY'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_EBRARYK'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_JSTOR'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_JSTOR15'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_LCL'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_NETL'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_NETLK'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_OXFORD'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_PLCI_03'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_PLCI_13'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_PLCI_14'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_PLCI_15'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EB_PLNT_03'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EI'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EN_ZZZ'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EP'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EP_JST'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EP_PJM'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EP_SAGE'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EP_ZZZ'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='ER'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EXHIBIT'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EZB'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EZB_LEND'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='EZBM'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='GD'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='GDER'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='GDMC'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='GDMF'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='GDML'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='GDR'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='I'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='ILLB'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='J'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='JEB'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='JO'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='MEND'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='MF'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='MFD'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='N'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='N_M'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='OBOC'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='ONORDER'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='P'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='P_C'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='P_M'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='P_P'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='PROBLEM'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='PROC'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='PROCCA'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='PROCLA'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='R'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='RE'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='RESE'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='RESM'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='RESP'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='RESS'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='RLAW'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SC'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCAR'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCBN'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCCR'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCD'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCDH'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCERS'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCH'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCM'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCMAP'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCMAPD'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCME'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCMS'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCPR'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCRB'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCRBD'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCRR'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCSTORAGE'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCT'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='SCW'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='STORAGE_02'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='UNASSIGNED'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='UNUSED'"&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:when test="marc:subfield[@code='d']='VC'"&gt;&lt;xsl:value-of select="$WILL_LEND"/&gt;&lt;/xsl:when&gt;&#xD;
                            &lt;xsl:otherwise&gt;&lt;xsl:value-of select="$WILL_NOT_LEND"/&gt;&lt;/xsl:otherwise&gt;&#xD;
                        &lt;/xsl:choose&gt;&#xD;
                        &lt;/illPolicyId&gt;&#xD;
                        &lt;permanentLocationIdHere&gt;&lt;xsl:value-of select="marc:subfield[@code='d']"/&gt;&lt;/permanentLocationIdHere&gt;&#xD;
                        &lt;callNumber&gt;&#xD;
                        &lt;xsl:for-each select="marc:subfield[@code='f']"&gt;&#xD;
                            &lt;xsl:if test="position() &gt; 1"&gt;&#xD;
                            &lt;xsl:text&gt; &lt;/xsl:text&gt;&#xD;
                            &lt;/xsl:if&gt;&#xD;
                            &lt;xsl:value-of select="."/&gt;&#xD;
                        &lt;/xsl:for-each&gt;&#xD;
                        &lt;/callNumber&gt;&#xD;
                        &lt;items&gt;&#xD;
                        &lt;arr&gt;&#xD;
                            &lt;xsl:for-each select="../marc:datafield[@tag='995']"&gt;&#xD;
                            &lt;xsl:if test="marc:subfield[@code='ff']=$holdingsId"&gt;&#xD;
                                &lt;i&gt;&#xD;
                                &lt;itemIdentifier&gt;&#xD;
                                    &lt;xsl:value-of select="marc:subfield[@code='a']"/&gt;&#xD;
                                &lt;/itemIdentifier&gt;&#xD;
                                &lt;barcode&gt;&#xD;
                                    &lt;xsl:value-of select="marc:subfield[@code='s']"/&gt;&#xD;
                                &lt;/barcode&gt;&#xD;
                                &lt;permanentLoanTypeId&gt;2b94c631-fca9-4892-a730-03ee529ffe27&lt;/permanentLoanTypeId&gt;                    &lt;!-- Can circulate --&gt;&#xD;
                                &lt;materialTypeId&gt;&#xD;
                                    &lt;!-- Mappings to ReShare specific material types, taken from OCLC table "Type of Record" --&gt;&#xD;
                                    &lt;xsl:choose&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='BOOK'"      &gt;e65ed344-a691-4f8f-8446-3c0a346c6882&lt;/xsl:when&gt; &lt;!-- BKS --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='ELEC'"      &gt;22cb5b81-2056-46ed-8050-c5d8f01caf90&lt;/xsl:when&gt; &lt;!-- COM --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='ISSUE'"     &gt;191da404-dec2-4977-9770-1443d9d6c238&lt;/xsl:when&gt; &lt;!-- CNR --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='MANUSCRIPT'"&gt;e65ed344-a691-4f8f-8446-3c0a346c6882&lt;/xsl:when&gt; &lt;!-- BKS --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='MAP'"       &gt;9f2c8d85-97e6-4722-a67c-bb51ccfb7781&lt;/xsl:when&gt; &lt;!-- MAP --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='OTHER'"     &gt;04858422-c46f-4041-94fc-f5c5a6b98319&lt;/xsl:when&gt; &lt;!-- Other --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='SCORE'"     &gt;e5578a7e-49b9-4859-a86a-21b812215b4f&lt;/xsl:when&gt; &lt;!-- SCO --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='RECORD'"    &gt;d8dc9046-a9f4-4789-adf5-678fd855b016&lt;/xsl:when&gt; &lt;!-- REC --&gt;&#xD;
                                    &lt;xsl:when test="marc:subfield[@code='t']='DVD'"       &gt;14f1845d-2fad-4091-80c8-48614eaea40b&lt;/xsl:when&gt; &lt;!-- VIS --&gt;&#xD;
                                    &lt;xsl:otherwise&gt;f6dd0721-5d4a-439e-9205-c71aef39d15b&lt;/xsl:otherwise&gt;                                    &lt;!-- Unmapped --&gt;&#xD;
                                    &lt;/xsl:choose&gt;&#xD;
                                &lt;/materialTypeId&gt;&#xD;
                                &lt;xsl:if test="marc:subfield[@code='g']"&gt;&#xD;
                                    &lt;volume&gt;&#xD;
                                    &lt;xsl:value-of select="marc:subfield[@code='g']"/&gt;&#xD;
                                    &lt;/volume&gt;&#xD;
                                &lt;/xsl:if&gt;&#xD;
                                &lt;status&gt;&#xD;
                                &lt;name&gt;Unknown&lt;/name&gt;&#xD;
                                &lt;/status&gt;&#xD;
                                &lt;/i&gt;&#xD;
                            &lt;/xsl:if&gt;&#xD;
                            &lt;/xsl:for-each&gt;&#xD;
                        &lt;/arr&gt;&#xD;
                        &lt;/items&gt;&#xD;
                    &lt;/i&gt;&#xD;
                    &lt;/xsl:for-each&gt;&#xD;
                &lt;/arr&gt;&#xD;
            &lt;/xsl:when&gt;&#xD;
            &lt;xsl:when test="marc:datafield[@tag='995']"&gt;&#xD;
                &lt;arr&gt;&#xD;
                    &lt;xsl:for-each select="marc:datafield[@tag='995']"&gt;&#xD;
                    &lt;i&gt;&#xD;
                        &lt;!-- No "900" tag (no holdings record), use ID of item as holdingsRecord ID as well --&gt;&#xD;
                        &lt;formerIds&gt;&#xD;
                        &lt;arr&gt;&#xD;
                            &lt;i&gt;&#xD;
                            &lt;xsl:value-of select="marc:subfield[@code='a']"/&gt;&#xD;
                            &lt;/i&gt;&#xD;
                        &lt;/arr&gt;&#xD;
                        &lt;/formerIds&gt;&#xD;
                        &lt;permanentLocationIdHere/&gt;&#xD;
                        &lt;items&gt;&#xD;
                        &lt;arr&gt;&#xD;
                            &lt;i&gt;&#xD;
                            &lt;itemIdentifier&gt;&#xD;
                                &lt;xsl:value-of select="marc:subfield[@code='a']"/&gt;&#xD;
                            &lt;/itemIdentifier&gt;&#xD;
                            &lt;barcode&gt;&#xD;
                                &lt;xsl:value-of select="marc:subfield[@code='s']"/&gt;&#xD;
                            &lt;/barcode&gt;&#xD;
                            &lt;permanentLoanTypeId&gt;2b94c631-fca9-4892-a730-03ee529ffe27&lt;/permanentLoanTypeId&gt;                      &lt;!-- Can circulate --&gt;&#xD;
                            &lt;materialTypeId&gt;&#xD;
                                &lt;xsl:choose&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='BOOK'"      &gt;1a54b431-2e4f-452d-9cae-9cee66c9a892&lt;/xsl:when&gt; &lt;!-- book --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='ELEC'"      &gt;615b8413-82d5-4203-aa6e-e37984cb5ac3&lt;/xsl:when&gt; &lt;!-- electronic resourse --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='ISSUE'"     &gt;d9acad2f-2aac-4b48-9097-e6ab85906b25&lt;/xsl:when&gt; &lt;!-- text --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='MANUSCRIPT'"&gt;d9acad2f-2aac-4b48-9097-e6ab85906b25&lt;/xsl:when&gt; &lt;!-- text --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='MAP'"       &gt;71fbd940-1027-40a6-8a48-49b44d795e46&lt;/xsl:when&gt; &lt;!-- unspecified --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='OTHER'"     &gt;71fbd940-1027-40a6-8a48-49b44d795e46&lt;/xsl:when&gt; &lt;!-- unspecified --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='SCORE'"     &gt;71fbd940-1027-40a6-8a48-49b44d795e46&lt;/xsl:when&gt; &lt;!-- unspecified --&gt;&#xD;
                                &lt;xsl:when test="marc:subfield[@code='t']='RECORD'"    &gt;dd0bf600-dbd9-44ab-9ff2-e2a61a6539f1&lt;/xsl:when&gt; &lt;!-- sound recording --&gt;&#xD;
                                &lt;xsl:otherwise&gt;71fbd940-1027-40a6-8a48-49b44d795e46&lt;/xsl:otherwise&gt;                                    &lt;!-- unspecified --&gt;&#xD;
                                &lt;/xsl:choose&gt;&#xD;
                            &lt;/materialTypeId&gt;&#xD;
                            &lt;xsl:if test="marc:subfield[@code='g']"&gt;&#xD;
                                &lt;volume&gt;&#xD;
                                &lt;xsl:value-of select="marc:subfield[@code='g']"/&gt;&#xD;
                                &lt;/volume&gt;&#xD;
                            &lt;/xsl:if&gt;&#xD;
                            &lt;status&gt;&#xD;
                                &lt;name&gt;Unknown&lt;/name&gt;&#xD;
                            &lt;/status&gt;&#xD;
                            &lt;/i&gt;&#xD;
                        &lt;/arr&gt;&#xD;
                        &lt;/items&gt;&#xD;
                    &lt;/i&gt;&#xD;
                    &lt;/xsl:for-each&gt;&#xD;
                &lt;/arr&gt;&#xD;
            &lt;/xsl:when&gt;&#xD;
            &lt;xsl:otherwise&gt;&#xD;
                &lt;arr&gt;&#xD;
                    &lt;i&gt;&#xD;
                    &lt;permanentLocationIdHere/&gt;&#xD;
                    &lt;/i&gt;&#xD;
                &lt;/arr&gt;&#xD;
            &lt;/xsl:otherwise&gt;&#xD;
        &lt;/xsl:choose&gt;&#xD;
    &lt;/holdingsRecords&gt;&#xD;
  &lt;/xsl:template&gt;&#xD;
  &lt;xsl:template match="text()"/&gt;&#xD;
&lt;/xsl:stylesheet&gt;&#xD;
</script>
        <testData></testData>
        <testOutput></testOutput>
    </XmlTransformStep>
</transformationStep>
